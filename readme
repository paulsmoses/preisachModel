This code I developed,  based on Preisach's model of hysteresis, implements a basic numerical implementation of the Preisach hysteresis nonlinearity in MATLAB-Simulink.   
I had started developing this during my doctoral studies and got it working, but have not developed it further.  Over the years, people have emailed me and asked for
the source code which was only available in my paper, published much later than its original development. 

  P. Moses, “A New Object-Oriented Simulation Tool for Modeling Preisach-Based Magnetic Hysteresis
  Nonlinearities”, WSEAS Transactions on Systems, vol. 17, 2018.

I had wanted to use it for transformer modeling, and had some success, but abandoned it, in favour of exploring three-phase transformer modeling. 
Here it is, for anyone who wants to use it or improve it.  I would only ask that if you do, I can incorporate your 
improvements in this Github repository if you use the Git version control system.  I'd recommend creating a fork of this repository, make
your improvements and I'll merge them in.   Alternatively, but not ideal, is you can email me your changes and I'll update the repository
giving you credit for the changes.

In the meantime, you can get started by cloning the repository or downloading it to your computer, and run the example simulink file in hysteresisBlock.mdl.
This file calls the preisachSimFuncSimpPUBLISH.m which contains the numerical implementation of the Preisach hysteresis mathematical formulation as defined in

I. D. Mayergoyz, Mathematical models of hysteresis and their applications, 1st ed. Amsterdam ; Boston: Elsevier, 2003.

The required first order reversal curve uses an example formula given in 

H. Lamba and et al., "The effect of circuit parameters on ferroresonant solutions in an LCR circuit," Journal of
Physics A: Mathematical and General, vol. 31, p. 7065, 1998. 

which is implemented in Fab.m, called from preisachSimFuncSimpPUBLISH.m.
